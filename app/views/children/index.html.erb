<div class="index-child-container">
  <div class="row">
    <div class="col-12 col-md-8 col-lg-8">
      <div class="container mt-3 mb-5">
        <a class="btn-child-show btn-lg btn-primary my-3" href="/children/new"><span>Create a <i class="far fa-address-card"></i></span></a>
        <% @children.each do |child| %>
          <div class="card-product my-3 mt-5">
            <% if child.photo.attached? %>
              <%= cl_image_tag child.photo.key%>
            <% else %>
              <%= image_tag "upload-photo.jpg" %>
            <% end %>
            <div class="card-product-infos">
              <h2><%= child.full_name(child) %></h2>
              <div class="d-flex justify-content-between">
                <div>
                  <p>Parents: <%= child.parent %> </p>
                  <p class='mb-4'>Hobby: <%= child.hobby %></p>
                  <%= link_to "Event details", child_path(child), class: "btn-child-show btn-small btn-primary p-2" %>
                </div>
                <div>
                  <p>Birthday: <%= child.birthday %></p>
                  <p><%= child.age(child) %> years old</p>
                  <p><%= child.gender %></p>
                  <%= link_to '🖋', edit_child_path(child)%>
                  <%= link_to  '❌',
                  child_path(child),
                  method: :delete, class: 'mx-3',
                  data: { confirm: "delete #{child.first_name} #{child.last_name}?"}%>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <div class="col-12 col-md-4 col-lg-4 sidenav mx-auto" style="overflow:auto">
      <h4 class="mt-4 mb-3">Event Calendar</h4>
      <div class="mb-5" id="events_calendar_index" style="padding-top: 30px" >
          <%# <% @children.each do |child| %>
            <%# <% child.events.each do |event| %>
              <%# <% if event.start_date >  Time.now %>
                <%# <% @all_events << event %>
              <%# <% end %>
            <%# <% end %>
          <%# <% end %>
          <%= render partial: "calendar_index", locals: {events: @all_events} %>
      </div>
      <div class="mt-5 mb-5" style="text-align:left">
        <div class="container calendar-events">
          <p class="mb-4" style="text-align:center">Upcoming Events</p>
          <% @all_events.sort_by(&:start_date).each do |event|%>
            <p><strong><%= event.start_date.strftime("%b #{event.start_date.day.ordinalize}")%></strong>: <%= event.child.first_name.capitalize %> | <%= event.occasion %> event</p>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
